<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" 
              name="InformeTecnicoDB" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
    
    <queryString>
        <![CDATA[
        SELECT 'Entidad: Libro (Book)' as CLASE, COUNT(*) as TOTAL FROM book
        UNION ALL
        SELECT 'Entidad: Autor (Author)', COUNT(*) FROM author
        UNION ALL
        SELECT 'Entidad: Usuario (Profile)', COUNT(*) FROM profile
        ]]>
    </queryString>

    <field name="CLASE" class="java.lang.String"/>
    <field name="TOTAL" class="java.lang.Long"/>

    <title>
        <band height="120">
            <rectangle>
                <reportElement x="0" y="0" width="555" height="80" backcolor="#000000"/>
            </rectangle>
            <staticText>
                <reportElement x="10" y="10" width="535" height="30" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center">
                    <font size="22" isBold="true"/>
                </textElement>
                <text><![CDATA[AUDITORÍA DE PERSISTENCIA]]></text>
            </staticText>
            <staticText>
                <reportElement x="10" y="45" width="535" height="20" forecolor="#CCCCCC"/>
                <textElement textAlignment="Center">
                    <font size="12"/>
                </textElement>
                <text><![CDATA[Arquitectura: Java 8 + Hibernate 5.2 + MySQL]]></text>
            </staticText>
            
            <textField pattern="dd/MM/yyyy HH:mm">
                <reportElement x="400" y="90" width="155" height="20"/>
                <textElement textAlignment="Right"/>
                <textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
            </textField>
        </band>
    </title>

    <columnHeader>
        <band height="30">
            <staticText>
                <reportElement x="0" y="0" width="300" height="20"/>
                <textElement>
                    <font size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[CLASE JAVA / TABLA BD]]></text>
            </staticText>
            <staticText>
                <reportElement x="300" y="0" width="255" height="20"/>
                <textElement textAlignment="Right">
                    <font size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[OBJETOS PERSISTIDOS]]></text>
            </staticText>
            <line>
                <reportElement x="0" y="25" width="555" height="1"/>
            </line>
        </band>
    </columnHeader>

    <detail>
        <band height="25">
            <textField>
                <reportElement x="0" y="0" width="300" height="20"/>
                <textElement>
                    <font size="12"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{CLASE}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="300" y="0" width="255" height="20"/>
                <textElement textAlignment="Right">
                    <font size="12" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{TOTAL}]]></textFieldExpression>
            </textField>
        </band>
    </detail>

    <summary>
        <band height="100">
            <line>
                <reportElement x="0" y="10" width="555" height="1"/>
            </line>
            <staticText>
                <reportElement x="0" y="20" width="555" height="20"/>
                <textElement>
                    <font size="14" isBold="true"/>
                </textElement>
                <text><![CDATA[DICTAMEN TÉCNICO:]]></text>
            </staticText>
            <staticText>
                <reportElement x="0" y="45" width="555" height="50"/>
                <textElement/>
                <text><![CDATA[Los datos mostrados arriba provienen directamente de la base de datos MySQL 'bookstore'. El sistema utiliza un pool de conexiones JDBC gestionado por Hibernate. La integridad de las tablas 'book', 'author' y 'profile' ha sido verificada.]]></text>
            </staticText>
        </band>
    </summary>

</jasperReport>